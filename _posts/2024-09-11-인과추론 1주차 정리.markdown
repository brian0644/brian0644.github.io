---
layout: post
title:  "인과추론 1주차 정리"
date:   2024-09-11 11:58+09:00
categories: khuda causal inference study
---

# 1-1. 인과추론이란?

* 연관관계 : 두 개의 수치나 확률변수가 같이(양,음) 움직이는 것 
* 인과관계 : 한 변수의 변화가 다른 변수의 변화를 일으키는 것
* 회귀의 의미에서 둘의 경계가 상당히 모호하기 때문에 쉽게 착각을 일으킴(수식을 봤을때 y=ax+u 라면 연관관계와 인과관계의 정의 모두 부합하는 것처럼 느껴진다...)
* 그치만 우리는 개념적인 해석 관점에서 둘이 명확히 다르다는 것을 암

 
> **비록 연관관계는 인과관계가 아니지만 때로는 연관관계가 인과관계가 될 수도 있다는것  -> how?를 추론하는 것이 인과추론**
> **인과추론은 연관관계로부터 인과관계를 추론하고 언제, 그리고 왜 서로 다른지 이해하는 과학**


  

# 1-2. 인과추론 예시


## 용어 정리
* T(처치) : 구하려는 효과에 대한 개입을 나타낼 때 사용하는 용어
* Y(결과) : 종속변수 Y, 주어진 효과에 따라 변화 양상을 지켜봐야하는 값
* T <- f(u) (외생변수) : 어떠한 다른 변수에도 영향을 **받지않는** 값, 관측(정의)되지 않은 다른 변수에 영향을 받지 않는 요인들 -> 처치를 정의할때는 외생변수 표기
* Y <- f(_...,u) )(내생변수) : 관측되지 않은 요인에 의해 영향을 받는 값 -> 결과를 정의할때는 내생변수 표기
* do(.) (개입) : 어떤 처치 T에서 동시에 일어날 수 없는 인과 추정량을 정의하는데 사용
  <img width="289" alt="스크린샷 2024-09-11 오후 12 37 45" src="https://github.com/user-attachments/assets/4644d254-ccf3-4bab-812c-f44f70300477">
* 잠재적 결과 : 두 개 이상의 처치에 관해 이야기할 때 나올 수 있는 모든 결과 경우의 수, 관측할 수 있는 것을 사실적 결과, 없는 것을 반사실적 결과
* 인과추정량 : 동시에 일어날 수 없어서 측정할 수 없는 대상, 곤측
* 식별 : 인과추정량에 대한 이론적 표현을 do(.)를 통하여 제거(구할 수 없지만 이론적으로 정의함으로써)하는 과정
* 개별 처치효과 (ITE) : <img width="159" alt="스크린샷 2024-09-11 오후 12 36 29" src="https://github.com/user-attachments/assets/38f2c4f5-4dcd-4cdd-ad4b-e38b878f5a08">
-> 같은 대상(i)의 결과를 동시에 측정한다는 가정 하에 두 처치에 대한 결과 차이값
* 





## Ex) 할인 캠페인과 판매량 분석
  우리가 할인 캠페인을 했을때 판매량이 늘어나는지를 보고싶다 -> 가격할인이 판매량에 미치는 영향을 파악해야함
할인 캠페인을 통해 더 많이 판매해 얻는 이익이 할인된 가격으로 팔았을때 얻는 손실을 상쇄할 때, 가격할인은 좋은 의사결정이 된다

  
<img width="347" alt="스크린샷 2024-09-11 오후 12 16 32" src="https://github.com/user-attachments/assets/44d4c9e8-1217-4326-a634-12a83acc99f6">


  
이런 상황에서는 T = is_on_sale, Y = weekly_amount_sold로 정의하여 세일을 했을때 얼마나 더 팔 수 있는가를 분석할 수 있음

<img width="349" alt="스크린샷 2024-09-11 오후 12 25 18" src="https://github.com/user-attachments/assets/ca77a808-9c51-49ed-a92c-12bbae968d5c">
  

그래서 간단하게 is_on_sale을 했던 집단과 하지 않았던 집단을 groupby, 판매량을 비교했음 -> 근데 이게 진짜 의미 있는 분석인가?
NO. 왜냐하면 해당 분석에서는 회사 자체의 규모나 그런 다른 요소(내생변수)들이 판매량에 영향을 미치고 있음 -> 아직 Y에 영향을 미치는 변수들을 다 고려하지 않았다


<img width="293" alt="스크린샷 2024-09-11 오후 12 29 58" src="https://github.com/user-attachments/assets/d29340cb-2828-498b-a84d-63afb0d456df">


그래서 이번엔 회사 규모도 포함시켜서 분석해봤음. 근데 다시 생각해보면 이게 맞는 분석법인가? 아무리 회사 규모를 포함시켯다고 한들 이렇게 추가해야할 특성들을 생각해서 추가하다보면 끝도없이 많을것...
즉, 가장 적절한 비교를 위해서는 동일한 실험 대상에 대하여 세일 했을 때 안했을 때를 비교해야한다
그러나 문제는 동일한 실험 대상이 T를 받은 상태와 받지 않은 상태를 동시에 관측할 수 없다는 점 -> 그러니까 효과를 알려면 **같은 회사가 동일 기간**에 할인했을때 판매량, 안했을때 판매량을 비교해야 진짜 의미가 있는건데... 구할 수가 없네... 이를 인과추정량이라고 부르며 이를 추상적으로 표현하기 위해 do(.) 개입 연산자를 활용하여 이를 식별(제거)하고자 하는 것










# 1-2. 인과추론의 목적
